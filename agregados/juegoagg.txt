use ej1

db.Juego.aggregate([
    // Etapa de $lookup para unir con la colección 'id'
    {
        $lookup: {
            from: "Incidencia",
            localField: "incidencias", 
            foreignField: "id", 
            as: "Inc"
        }
    },
    // Etapa de $project para seleccionar y renombrar los campos deseados
    {
        $project: {
            "id": 1,
            "modelo": 1,
            "estadoOperativo": 1,
            "accesibilidad": 1,
            "fechaInstalacion": 1,
            "tipo": 1,
            "desgasteAcumulado": 1,
            "indicadorExposicion": 1,
            "ultimaFechaMantenimiento": 1,
            "mantenimientos": 1,
            "incidencias": 1,
            //RefMantenimiento
            RefMant: "$Mantenimiento",
            //RefIncidencia - selecciona campos de 'Inc' obtenido en $lookup
            "Inc.fechaReporte": 1,
            "Inc.tipo": 1,
            "Inc.estado": 1
        }
    },
    // Etapa de $out para exportar los resultados a otra colección
    {
        $out: { db: "ej1", coll: "Temp2" }
    }
])
